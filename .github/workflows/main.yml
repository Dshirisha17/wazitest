name: SSH Command via CMD on Windows with sshpass

on:
  push:
    branches:
      - main

jobs:
  ssh-job:
    runs-on: self-hosted

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Run SSH command on Windows
      run: |
        $host = "10.10.1.180"
        $username = "ibmuser"
        $password = "s3cure"
        $port = 2222

        # Run the SSH command with sshpass (assuming sshpass.exe is in PATH)
        sshpass.exe -p "$password" ssh -o StrictHostKeyChecking=no -p "$port" "$username@$host" 'whoami'
      shell: cmd
